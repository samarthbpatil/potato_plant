import streamlit as st
import tensorflow as tf
import numpy as np
from PIL import Image
import matplotlib.pyplot as plt

# Load the trained model
model_path = "C:\Users\samar\potato_plant_disease\saved_model.pb"  # Specify the actual path to your saved model
model = tf.keras.models.load_model(model_path)

# Define the class names
class_names = ['Potato___Early_blight', 'Potato___Late_blight', 'Potato___healthy] 
 # Replace with your actual class names

# Function to preprocess the uploaded image
def preprocess_image(image):
    img = tf.image.decode_image(image.read(), channels=3)
    img = tf.image.resize(img, (256, 256))
    img = tf.image.convert_image_dtype(img, tf.float32)
    img = tf.expand_dims(img, 0)
    return img

# Streamlit app
st.title("Potato Leaf Disease Detection")

# Upload an image through the Streamlit interface
uploaded_file = st.file_uploader("Choose an image...", type=["jpg", "jpeg", "png"])

if uploaded_file is not None:
    # Preprocess the uploaded image
    image = preprocess_image(uploaded_file)

    # Display the uploaded image
    st.image(tf.squeeze(image, axis=0).numpy(), caption="Uploaded Image", use_column_width=True)

    # Make predictions
    predictions = model.predict(image)
    predicted_class = class_names[np.argmax(predictions[0])]

    # Display the predicted class
    st.subheader("Prediction:")
    st.write(f"The model predicts: {predicted_class}")
